#!/usr/bin/env ruby

require 'gli'
require 'decking'

Decking::Parser.config_file File.expand_path(File.dirname(__FILE__)) + '/../spec/resources/decking-container-tests.yaml'

module Decking::CLI
  extend GLI::App
  config_file '.deckingrc'
  program_desc "Manage a cluster of docker containers"

  command :create do |c|
    c.action do |global_options,options,args|
      puts global_options.inspect,options.inspect,args.inspect
      cluster_name = args[0]
      Decking::Parser.parse cluster_name
      Decking::Parser.config.containers.map { |name, config| Decking::Container.add config }
      Decking::Container.create_all!
    end
  end
end

exit Decking::CLI.run(ARGV)

